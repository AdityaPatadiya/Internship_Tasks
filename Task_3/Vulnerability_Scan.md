# Vulnerability Scan for Metasploitable2:

## Target System Details:

IP Address: 192.168.75.129

MAC Address: 00:0C:29:FC:10:8F

Operating System: Linux Kernel 2.6 on Ubuntu 8.04 (hardy)

Scan Duration: 10 minutes

Scan Time: 10:42 AM – 10:51 AM

Tool Used: (Based on UI, likely OpenVAS, Nessus, or similar)

## Nmap scan result for the machine:
```
┌──(aditya㉿kali)-[~]
└─$ nmap -sS -A 192.168.75.129      
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-29 16:43 IST
Nmap scan report for 192.168.75.129
Host is up (0.00081s latency).
Not shown: 978 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.75.128
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_DES_192_EDE3_CBC_WITH_MD5
|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
|     SSL2_RC4_128_WITH_MD5
|     SSL2_RC2_128_CBC_WITH_MD5
|     SSL2_DES_64_CBC_WITH_MD5
|_    SSL2_RC4_128_EXPORT40_WITH_MD5
|_ssl-date: 2025-05-29T11:13:29+00:00; +2s from scanner time.
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
|_http-title: Metasploitable2 - Linux
111/tcp  open  rpcbind     2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      45465/udp   mountd
|   100005  1,2,3      58022/tcp   mountd
|   100021  1,3,4      54064/udp   nlockmgr
|   100021  1,3,4      60030/tcp   nlockmgr
|   100024  1          45194/tcp   status
|_  100024  1          48014/udp   status
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login       OpenBSD or Solaris rlogind
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 8
|   Capabilities flags: 43564
|   Some Capabilities: SwitchToSSLAfterHandshake, ConnectWithDatabase, SupportsTransactions, LongColumnFlag, Support41Auth, SupportsCompression, Speaks41ProtocolNew
|   Status: Autocommit
|_  Salt: n`rA*N++7nJc5z-m_sE>
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
|_ssl-date: 2025-05-29T11:13:29+00:00; +2s from scanner time.
5900/tcp open  vnc         VNC (protocol 3.3)
| vnc-info: 
|   Protocol version: 3.3
|   Security types: 
|_    VNC Authentication (2)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
| irc-info: 
|   users: 1
|   servers: 1
|   lusers: 1
|   lservers: 0
|   server: irc.Metasploitable.LAN
|   version: Unreal3.2.8.1. irc.Metasploitable.LAN 
|   uptime: 0 days, 0:00:38
|   source ident: nmap
|   source host: D76C5AC4.93D7CABE.FFFA6D49.IP
|_  error: Closing Link: pwtgucxua[192.168.75.128] (Quit: pwtgucxua)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
|_ajp-methods: Failed to get a valid response for the OPTION request
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
|_http-favicon: Apache Tomcat
|_http-title: Apache Tomcat/5.5
|_http-server-header: Apache-Coyote/1.1
MAC Address: 00:0C:29:FC:10:8F (VMware)
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.33
Network Distance: 1 hop
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_smb2-time: Protocol negotiation failed (SMB2)
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2025-05-29T07:13:22-04:00
|_clock-skew: mean: 1h00m02s, deviation: 2h00m00s, median: 1s
|_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb-security-mode: 
|   account_used: <blank>
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)

TRACEROUTE
HOP RTT     ADDRESS
1   0.81 ms 192.168.75.129

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 22.71 seconds
```

So many ports are open in this machine.

The above information shows top 1000 status of the ports with the services they are running, state of each port, and version of that service.

This information helps to find vulneracility for that machine.

## Vulnerability scan result with Nessus:
![image](https://github.com/user-attachments/assets/d4a34202-88ce-476a-91a8-fe25c49ba3ab)
![image](https://github.com/user-attachments/assets/43f335df-2a42-43e4-8dc5-adb6dd082f85)

In above two images, It shows all the vulnerabilities with their severity level.

Total 72 vulnerabilities found

10 Critical vulnerability (>8)

7 high vulnerability (6.5> and <8)

## Most Critical Vulnerabilities:
| Severity     | Name                          | CVSS | Description                                                                                               | Mitigation                                                                   |
| ------------ | ----------------------------- | ---- | --------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------- |
| **Critical** | UnrealIRCd Backdoor           | 10.0 | A malicious version of UnrealIRCd with a built-in backdoor allows attackers to execute commands remotely. | Remove and reinstall from trusted sources. Verify integrity using hashes.    |
| **Critical** | VNC Server 'password' Bypass  | 10.0 | VNC service uses a known default or weak password allowing unauthorized shell access.                     | Disable VNC or enforce strong passwords. Limit access to trusted IPs only.   |
| **Critical** | Apache Tomcat AJP Connector   | 9.8  | Insecure AJP configuration allows file inclusion and remote code execution.                               | Disable AJP if unused or restrict access via firewall. Patch Apache Tomcat.  |
| **Critical** | SSL Version 2 and 3 Support   | 9.8  | Deprecated SSL protocols are vulnerable to downgrade attacks like POODLE.                                 | Disable SSLv2/v3. Enforce TLS 1.2 or 1.3 only.                               |
| **Critical** | Bind Shell Backdoor Detection | 9.8  | The system is running a known backdoor that allows unauthenticated remote shell access.                   | Remove the backdoor. Reinstall affected services. Restrict network access.   |
| **Critical** | SSL (Multiple Issues)         | —    | Multiple SSL-related vulnerabilities detected.                                                            | Apply SSL hardening. Use modern ciphers. Disable weak protocols and ciphers. |

## Simple Fixes and Mitigation (For All Found Issues)
| Category                     | Suggested Mitigations                                                                                |
| ---------------------------- | ---------------------------------------------------------------------------------------------------- |
| **Backdoors**                | Reinstall affected software from trusted repositories. Monitor system for unauthorized connections.  |
| **Weak/Default Credentials** | Enforce strong password policies. Disable unused accounts/services.                                  |
| **Service Detection**        | Disable unused legacy services (rlogin, rsh). Use SSH instead.                                       |
| **RPC/NFS Issues**           | Disable world-readable NFS shares. Use strong authentication and access control lists.               |
| **SSL/TLS**                  | Upgrade to TLS 1.2/1.3. Disable insecure protocols and ciphers. Use certificates from trusted CAs.   |
| **OS/Kernel**                | Upgrade the OS and kernel. Ubuntu 8.04 is unsupported and insecure. Move to a supported LTS version. |

## Recommendations:

Prioritize fixing all Critical issues immediately, especially those offering remote shell access.

Apply network segmentation, firewall rules, and intrusion detection systems.

Harden services like VNC, Tomcat, NFS, and Samba.

Migrate from obsolete OS (Ubuntu 8.04) to a secure, maintained version.

Conduct periodic scans and integrate continuous monitoring.
